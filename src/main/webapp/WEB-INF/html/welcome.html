<html>
<head>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<style type="text/css">
.header {
	background-color: black;
	color: white;
	text-align: center;
	padding: 5px;
}

.mainContainer {
	width: 60%;
	float: left;
	position: absolute;
	top: 0;
	bottom: 0;
	left: 0;
	right: 0;
	margin: auto;
}

.row {
	width: 46%;
	float: left;
	padding: 2%;
}

.row label {
	float: left;
	padding-right: 10px;
	width: 90px;
}

.row input[type="text"] {
	float: left;
}

.btnContainer {
	text-align: center;
}

#tblEmpDetail {
	height: 400px;
	overflow-y: auto;
	width: 100%;
	padding-top: 10px;
}

#tblEmpDetail table {
	width: 100%;
}

#tblEmpDetail table tr:hover {
	background-color: lightblue;
}

#tblEmpDetail .empTableHeader {
	font-weight: bold;
}
</style>
<script type="text/javascript">

var selectedEmpId = "";
function searchEmployee(){
	var url = "/employee?";
	/* if($("#lastName").val() != ""){
		url += "&lastName="+$("#txtEmpLastName").val();
	}
	if($("#firstName").val() != ""){
		url += "&firstName="+$("#txtEmpFirstName").val();
	}
	if($("#email").val() != ""){
		url += "&email="+$("#txtEmpEmail").val();
	}
	if($("#phone").val() != ""){
		url += "&phone="+$("#txtEmpPhone").val();
	} */

	url += $("#employeeForm").serialize();
	
	$.get(url, function(data, status){
		$("#tblEmpDetail").empty();
		if(data.length > 0){
			var empTable = "<table><tr  class='empTableHeader'><td>First Name</td><td>Last Name</td><td>Email</td><td>Phone</td></tr>";
            for(var i=0; i < data.length; i++){
            	empTable += "<tr onclick='setEmployee("+data[i].id+")' ><td>"+data[i].firstName+"</td><td>"+data[i].lastName+"</td><td>"
            			+data[i].email+"</td><td>"+data[i].phone+"</td><td style='display : none;' >"+data[i].id+"</td></tr>";
            }
            $("#tblEmpDetail").append(empTable+"</table>");
		}else{
			 $("#tblEmpDetail").append("No data Found");
		}
    });
}

function resetEmployee(){
	$("#txtEmpFirstName").val("");
	$("#txtEmpLastName").val("");
	$("#txtEmpPhone").val("");
	$("#txtEmpEmail").val("");
	$("#tblEmpDetail").empty();
	selectedEmpId = "";
}


function saveEmployee(){
	var url = "/employee";
	var data = {
			firstName : $("#txtEmpFirstName").val(),
			lastName : $("#txtEmpLastName").val(),
			email : $("#txtEmpEmail").val(),
			phone : $("#txtEmpPhone").val(),
			};
	
	$.ajax({
		type : "POST",
		url : url,
		data : JSON.stringify(data),
		contentType: "application/json",
		success : function(data) {
	         alert(data);
	         resetEmployee();
	         searchEmployee();
      	}, error : function(error){}
	});
	
}

function setEmployee(employeeId){
	var url = "/employee/"+employeeId;
	$.get(url, function(data, status){
		selectedEmpId = employeeId;
		$("#txtEmpFirstName").val(data.firstName);
 		$("#txtEmpLastName").val(data.lastName);
 		$("#txtEmpEmail").val(data.email);
 		$("#txtEmpPhone").val(data.phone);
	});
}

function deleteEmployee(){
	if(selectedEmpId != ""){
		$.ajax({
			type : "DELETE",
			url : '/employee/'+selectedEmpId,
			success : function(data) {
		         alert(data.message);
		         resetEmployee();
		         searchEmployee();
	      	}, error : function(error){}
		});
	}
}

</script>
</head>
<body>
	<div class="mainContainer">
		<form id="employeeForm">
			<div class="header">
				<h2 align="center">Employee</h2>
			</div>
			<div class="row">
				<label>First Name:</label>
				<div class="inputField">
					<input type="text" name="txtEmpFirstName" id="txtEmpFirstName">
				</div>
			</div>
			<div class="row">
				<label>Last Name:</label>
				<div class="inputField">
					<input type="text" name="txtEmpLastName" id="txtEmpLastName">
				</div>
			</div>
			<div class="row">
				<label>Email:</label>
				<div class="inputField">
					<input type="email" name="txtEmpEmail" id="txtEmpEmail">
				</div>
			</div>
			<div class="row">
				<label>Phone:</label>
				<div class="inputField">
					<input type="text" name="txtEmpPhone" id="txtEmpPhone">
				</div>
			</div>
			<div class="btnContainer">
				<input type="button" id="btnSearch" onclick="searchEmployee()" value="Search"> 
				<input type="submit" value="Save" onclick="saveEmployee()"> 
				<input type="button" value="Delete" onclick="deleteEmployee()">
				<input type="button" value="Reset" onclick="resetEmployee()">
			</div>
			<div id="tblEmpDetail"></div>
		</form>
	</div>
</body>
</html>
