<style type="text/css">


.empContainer .header {
	text-align: center;
	padding: 5px;
}

.empContainer .row {
	width: 46%;
	float: left;
	padding: 2%;
}

.empContainer .row label {
	float: left;
	padding-right: 10px;
	width: 90px;
}

.empContainer .row input[type="text"] {
	float: left;
}

.empContainer .btnContainer {
	text-align: center;
}

.highlight td {
	background: #b7d4de !important;
}

</style>
<script type="text/javascript">

var selectedEmpId = "";


function resetEmployee(){
	$("#txtEmpFirstName").val("");
	$("#txtEmpLastName").val("");
	$("#txtEmpPhone").val("");
	$("#txtEmpEmail").val("");
	$("#tblEmpDetail").empty();
	$("#btnSaveEmployee").val("Save");
	selectedEmpId = "";
	searchEmployee();
}


function saveEmployee(){
	var url = "rest/employee";
	var type = "POST";
	var data = {
			firstName : $("#txtEmpFirstName").val(),
			lastName : $("#txtEmpLastName").val(),
			email : $("#txtEmpEmail").val(),
			phone : $("#txtEmpPhone").val(),
			};
	if(selectedEmpId != ""){
		type = "PUT";
		url += "/"+selectedEmpId;
	}
	
	$.ajax({
		type : type,
		url : url,
		data : JSON.stringify(data),
		contentType: "application/json",
		success : function(data) {
	         alert(data.Success);
	         resetEmployee();
	         searchEmployee();
      	}, error : function(error){ alert(JSON.stringify(error.responseText));}
	});
	
}

function setEmployee(employeeId){
	var url = "rest/employee/"+employeeId;
	$.get(url, function(data, status){
		selectedEmpId = employeeId;
		$("#btnSaveEmployee").val("Update");
		$("#txtEmpFirstName").val(data.firstName);
 		$("#txtEmpLastName").val(data.lastName);
 		$("#txtEmpEmail").val(data.email);
 		$("#txtEmpPhone").val(data.phone);
	});
}

function deleteEmployee(){
	if(selectedEmpId != ""){
		$.ajax({
			type : "DELETE",
			url : 'rest/employee/'+selectedEmpId,
			success : function(data) {
		         alert(data.Success);
		         resetEmployee();
		         searchEmployee();
	      	}, error : function(error){ alert(error.Error); }
		});
	}
}


function searchEmployee(){

	$("#tblEmpGrid").jsGrid({
        height: "auto",
        width: "100%",
        sorting: true,
        loadIndicationDelay: 1,
        autoload: true,
        controller: {
            loadData: function() {
                var d = $.Deferred();

            	var url = "rest/employee?";
				url += $("#employeeForm").serialize();
				$.ajax({
					type : "GET",
					url : url,
				    dataType: "json"
                }).done(function(response) {
                    d.resolve(response);
                });

                return d.promise();
            }
        },
        fields: [
            { title: "First Name", name: "firstName", type: "text"},
            { title: "Last Name", name: "lastName", type: "textarea" },
            { title: "Email", name: "email", type: "textarea" },
            { title: "Phone", name: "phone", type: "textarea"},
        ],
         rowClick: function(item) {

     	 	var $row = this.rowByItem(item.item);
        	$("#tblEmpGrid tr").each(function() {
          
          	    $this = $(this)
	            if($this.hasClass("highlight")){
	            	$this.removeClass("highlight");
	            }
        	
        	});
          
          	$row.addClass("highlight");
			setEmployee(item.item.id);
        }
     

    });
}

searchEmployee();

</script>
<div class="empContainer">
	<form id="employeeForm">
		<div class="header">
			<h2 align="center">Employee</h2>
		</div>
		<div class="row">
			<label>First Name:</label>
			<div class="inputField">
				<input type="text" name="txtEmpFirstName" id="txtEmpFirstName">
			</div>
		</div>
		<div class="row">
			<label>Last Name:</label>
			<div class="inputField">
				<input type="text" name="txtEmpLastName" id="txtEmpLastName">
			</div>
		</div>
		<div class="row">
			<label>Email:</label>
			<div class="inputField">
				<input type="text" name="txtEmpEmail" id="txtEmpEmail">
			</div>
		</div>
		<div class="row">
			<label>Phone:</label>
			<div class="inputField">
				<input type="text" name="txtEmpPhone" id="txtEmpPhone">
			</div>
		</div>
		<div class="btnContainer">
			<input type="button" id="btnSearch" onclick="searchEmployee()"
				value="Search"> <input type="button" value="Save"
				onclick="saveEmployee()" id="btnSaveEmployee"> <input
				type="button" value="Delete" onclick="deleteEmployee()"> <input
				type="button" value="Reset" onclick="resetEmployee()"> 
		</div>
		
		<div id="tblEmpGrid" style="width : 100%; padding-top: 10px;"></div>


	</form>
</div>